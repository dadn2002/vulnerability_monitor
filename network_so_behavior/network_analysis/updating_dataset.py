import subprocess
import os
import time

def run_exe(exe_path):
    if not os.path.isfile(exe_path):
        print(f"Executable {exe_path} does not exist.")
        return

    try:
        result = subprocess.run([exe_path], check=True, capture_output=True, text=True)
        print("Executable output:", result.stdout)
    except subprocess.CalledProcessError as e:
        print(f"Executable returned an error: {e.returncode}")
        print("Error output:", e.stderr)
    except Exception as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    current_directory = os.path.dirname(os.path.abspath(__file__))
    exe_to_run = os.path.join(current_directory, '..', 'extracting_data', 'extract_data.exe')
    exe_to_run = os.path.normpath(exe_to_run)
    
    # in seconds
    interval = 60 
    print(f"Running executable: {exe_to_run}")
    print(f"Interval between updates: 60")

    while True:
        run_exe(exe_to_run)
        time.sleep(interval)
