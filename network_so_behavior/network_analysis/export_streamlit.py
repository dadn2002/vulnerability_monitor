import streamlit as st
import streamlit.components.v1 as components
import os

def get_process_name_from_path(path:str) -> str:
    redacted_graph_name = path.replace('/mount/src/vulnerability_monitor/network_so_behavior/network_analysis/graphs/', '')
    redacted_graph_name = redacted_graph_name.replace('filtered_', '').replace('_process_network_graph.html', '')
    return redacted_graph_name


html_paths = [
    #os.path.join(os.path.dirname(__file__), 'graphs', 'process_network_graph.html'), #complete_graph, probably lagging
    os.path.join(os.path.dirname(__file__), 'graphs', 'filtered_steamwebhelper_process_network_graph.html'),
    os.path.join(os.path.dirname(__file__), 'graphs', 'filtered_discord_process_network_graph.html')
]

for path in html_paths:
    redacted_graph_name = get_process_name_from_path(path)
    st.write(f"Displaying graph of process: {redacted_graph_name}")
    with open(path, 'r') as file:
        html_content = file.read()
    components.html(html_content, height=600)
