#include <windows.h>
#include <iostream>
#include <fstream>
#include <thread>
#include <chrono>

void CreateFileHandle() {
    // Open a file and keep the handle open
    HANDLE hFile = CreateFile(
        "testfile.txt",               // File name
        GENERIC_READ | GENERIC_WRITE, // Desired access
        0,                            // Share mode
        NULL,                          // Security attributes
        CREATE_ALWAYS,                 // Creation disposition
        FILE_ATTRIBUTE_NORMAL,         // Flags and attributes
        NULL                           // Template file
    );

    if (hFile == INVALID_HANDLE_VALUE) {
        std::cerr << "Failed to create file handle." << std::endl;
        return;
    }

    std::cout << "File handle created: " << hFile << std::endl;

    // Keep the handle open and idle
    std::this_thread::sleep_for(std::chrono::minutes(10)); // Sleep for 10 minutes

    CloseHandle(hFile);
    std::cout << "File handle closed." << std::endl;
}

int main() {
    CreateFileHandle();
    return 0;
}
